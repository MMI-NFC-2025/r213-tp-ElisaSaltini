---
import Layout from "../../../../layouts/Layout.astro";
import Offrecard from "../../../../components/OffreCard.astro";
import { getOffres } from "../../../../backend.mjs";

const { min, max } = Astro.params;
const minPrix = Number(min);
const maxPrix = Number(max);

const offres = (await getOffres()).filter((o) => {
    const p = Number(o.prix);
    return p >= minPrix && p <= maxPrix;
});
---

<Layout titre={`Prix entre ${minPrix}€ et ${maxPrix}€`}>
    <div class="px-4 py-6">
        <h1 class="text-4xl font-bold text-gray-900 mt-2 mb-4">
            Maisons entre {minPrix} € et {maxPrix} €
        </h1>

        <div class="mt-5 grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
            {
                offres.map((offre) => (
                    <div
                        class="offre"
                        data-favori={offre.favori?.toString() ?? "false"}
                    >
                        <Offrecard offre={offre} />
                    </div>
                ))
            }
        </div>

        <a
            href="/offres"
            class="mt-8 inline-block rounded-lg bg-slate-700 px-4 py-2 text-sm font-semibold text-white hover:bg-slate-800"
        >
            Retour aux offres
        </a>
    </div>
</Layout>
